---
# ---------------------------------------------------------------------------
# onetime / defaults / main.yml
# One-time migration / setup role.  Idempotency is enforced via marker files
# so that re-running the playbook does NOT re-execute completed tasks.
# ---------------------------------------------------------------------------

# Master switch
onetime_enabled: true

# Unique identifier for this one-time operation
onetime_operation_id: "default_onetime_op"

# Marker-file directory â€” each completed op drops a marker here
onetime_marker_dir: /var/lib/ansible_onetime

# Force re-execution even if the marker exists (emergency use only)
onetime_force: false

# ---------- Pre-flight checks -----------------------------------------------
# Shell commands that must exit 0 before the operation proceeds
onetime_preflight_checks: []

# ---------- Operation payload -----------------------------------------------
# Path (on control node) to a script that performs the actual migration
onetime_migration_script: ""      # set per playbook invocation
# Extra args passed to the migration script
onetime_migration_args: ""

# ---------- Rollback -----------------------------------------------------------
# Script on control node that undoes the operation if something fails
onetime_rollback_script: ""
onetime_rollback_on_failure: true

# ---------- Audit & notifications ------------------------------------------
onetime_audit_log_dir: /var/log/ansible_onetime
onetime_slack_webhook_url: ""
