---
- name: Production Infrastructure Automation
  hosts: all
  gather_facts: true
  
  pre_tasks:
    - name: Display target host
      ansible.builtin.debug:
        msg: "Running automation on {{ inventory_hostname }}"
  
  roles:
    # Baseline configuration
    - role: configuration
      tags: [config, baseline]
      vars:
        configuration_ntp_enabled: true
        configuration_sysctl_enabled: true
    
    # SLA monitoring
    - role: sla
      tags: [sla, monitoring]
      when: environment == "production"
    
    # Operational maintenance
    - role: operational
      tags: [ops, maintenance]
      vars:
        operational_services:
          - nginx
          - postgresql
          - redis
        operational_backup_enabled: true
  
  post_tasks:
    - name: Run diagnostics
      ansible.builtin.include_role:
        name: troubleshooting
      vars:
        troubleshooting_depth: basic
      tags: [never, diagnostics]
